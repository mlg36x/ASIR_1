CREATE DATABASE IF NOT EXISTS EMPRESA;
USE EMPRESA;
CREATE TABLE IF NOT EXISTS  TCENTR (
 NUMCE DECIMAL(38,0)  PRIMARY KEY ,
 NOMCE VARCHAR(25) NOT NULL,
 SENIAS VARCHAR(25) NOT NULL
);

CREATE TABLE IF NOT EXISTS TDEPTO (
 NUMDE DECIMAL(38,0)  PRIMARY KEY,
 NUMCE DECIMAL(38,0) NOT NULL REFERENCES TCENTR,
 DIREC DECIMAL(38,0) NOT NULL,
 TIDIR VARCHAR(1)  NOT NULL CHECK(TIDIR IN ('P','F')),
 PRESU DECIMAL(38,2) NOT NULL,
 DEPDE DECIMAL(38,0) REFERENCES  TDEPTO ,
 NOMDE VARCHAR(20) NOT NULL 
  ) ;




CREATE TABLE IF NOT EXISTS TEMPLE (
NUMEM DECIMAL(38,0)  PRIMARY KEY,
NUMDE DECIMAL(38,0)  NOT NULL REFERENCES TDEPTO,
EXTEL DECIMAL(38,0)  NOT NULL,
FECNA DATE          NOT NULL,
FECIN DATE          NOT NULL,
SALAR DECIMAL(38,2)  NOT NULL,
COMIS DECIMAL(38,2)          ,
NUMHI DECIMAL(38,0)  NOT NULL,
NOMEM VARCHAR(16)  NOT NULL
);



INSERT INTO TCENTR VALUES(10,'SEDE CENTRAL','C. ALCALA, 820, MADRID');
INSERT INTO TCENTR VALUES(20,'RELACION CON CLIENTES','C. ATOCHA, 405, MADRID');  

INSERT INTO TDEPTO VALUES(100,10,260,'P',12,NULL,'DIRECCION GENERAL');
INSERT INTO TDEPTO VALUES(110,20,180,'P',15,100,'DIRECC.COMERCIAL');    
INSERT INTO TDEPTO VALUES(111,20,180,'F',11,110,'SECTOR INDUSTRIAL');   
INSERT INTO TDEPTO VALUES(112,20,270,'P',9,110,'SECTOR SERVICIOS');    
INSERT INTO TDEPTO VALUES(120,10,150,'F',3,100,'ORGANIZACION');        
INSERT INTO TDEPTO VALUES(121,10,150,'P',2,120,'PERSONAL');            
INSERT INTO TDEPTO VALUES(122,10,350,'P',6,120,'PROCESO DE DATOS');    
INSERT INTO TDEPTO VALUES(130,10,310,'P',2,100,'FINANZAS');            


INSERT INTO TEMPLE VALUES(110,121,350,'1929/11/10','1950/02/15',310,NULL,  3,'PONS, CESAR');
INSERT INTO TEMPLE VALUES(120,112,840,'1935/06/09','1968/10/01',350,111,   1,'LASA, MARIO');
INSERT INTO TEMPLE VALUES(130,112,810,'1945/09/09','1969/02/01',290,110,   2,'TEROL, LUCIANO');
INSERT INTO TEMPLE VALUES(150,121,340,'1930/08/10','1948/01/15',440,NULL,  0,'PEREZ, JULIO');
INSERT INTO TEMPLE VALUES(160,111,740,'1939/07/09','1968/11/11',310,110,   2,'AGUIRRE, AUREO');
INSERT INTO TEMPLE VALUES(180,110,508,'1934/10/18','1956/03/18',480,50,    2,'PEREZ, MARCOS');
INSERT INTO TEMPLE VALUES(190,121,350,'1932/05/12','1962/02/11',300,NULL,  4,'VEIGA, JULIANA');
INSERT INTO TEMPLE VALUES(210,100,200,'1940/09/28','1959/01/22',380,NULL,  2,'GALVEZ, PILAR');
INSERT INTO TEMPLE VALUES(240,111,760,'1942/02/26','1966/02/24',280,100,   3,'SANZ, LAVINIA');
INSERT INTO TEMPLE VALUES(250,100,250,'1946/10/27','1967/03/01',450,NULL,  0,'ALBA, ADRIANA');
INSERT INTO TEMPLE VALUES(260,100,220,'1943/12/03','1968/07/12',720,NULL,  6,'LOPEZ, ANTONIO');
INSERT INTO TEMPLE VALUES(270,112,800,'1945/05/21','1966/09/10',380,80,    3,'GARCIA, OCTAVIO');
INSERT INTO TEMPLE VALUES(280,130,410,'1948/01/11','1971/10/08',290,NULL,  5,'FLOR, DOROTEA');
INSERT INTO TEMPLE VALUES(285,122,620,'1949/10/25','1968/02/15',380,NULL,  0,'POLO, OTILIA');
INSERT INTO TEMPLE VALUES(290,120,910,'1947/11/30','1968/02/14',270,NULL,  3,'GIL, GLORIA');
INSERT INTO TEMPLE VALUES(310,130,480,'1946/11/21','1971/01/15',420,NULL,  0,'GARCIA, AUGUSTO');
INSERT INTO TEMPLE VALUES(320,122,620,'1957/12/25','1978/02/05',405,NULL,  2,'SANZ, CORNELIO');
INSERT INTO TEMPLE VALUES(330,112,850,'1948/08/19','1972/03/01',280,90,    0,'DIEZ, AMELIA');
INSERT INTO TEMPLE VALUES(350,122,610,'1949/04/13','1984/09/10',450,NULL,  1,'CAMPS, AURELIO');
INSERT INTO TEMPLE VALUES(360,111,750,'1958/10/29','1968/10/10',250,100,   2,'LARA, DORINDA');
INSERT INTO TEMPLE VALUES(370,121,360,'1967/06/22','1987/01/20',190,NULL,  1,'RUIZ, FABIOLA');
INSERT INTO TEMPLE VALUES(380,122,880,'1968/03/30','1988/01/01',180,NULL,  0,'MARTIN, MICAELA');
INSERT INTO TEMPLE VALUES(390,110,500,'1966/02/19','1986/10/08',215,NULL,  1,'MORAN, CARMEN');
INSERT INTO TEMPLE VALUES(400,111,780,'1969/08/18','1987/11/01',185,NULL,  0,'LARA, LUCRECIA');
INSERT INTO TEMPLE VALUES(410,122,660,'1968/07/14','1988/10/13',175,NULL,  0,'MUOZ, AZUCENA');
INSERT INTO TEMPLE VALUES(420,130,450,'1966/10/22','1988/11/19',400,NULL,  0,'FIERRO, CLAUDIA');
INSERT INTO TEMPLE VALUES(430,122,650,'1967/02/26','1988/11/19',210,NULL,  1,'MORA, VALERIANA');
INSERT INTO TEMPLE VALUES(440,111,760,'1966/09/26','1986/02/28',210,100,   0,'DURAN, LIVIA');
INSERT INTO TEMPLE VALUES(450,112,880,'1966/10/21','1986/02/28',210,100,   0,'PEREZ, SABINA');
INSERT INTO TEMPLE VALUES(480,111,760,'1965/04/04','1986/02/28',210,100,   1,'PINO, DIANA');
INSERT INTO TEMPLE VALUES(490,112,880,'1964/06/06','1988/01/01',180,100,   0,'TORRES, HORACIO');
INSERT INTO TEMPLE VALUES(500,111,750,'1965/10/08','1987/01/01',200,100,   0,'VAZQUEZ, HONORIA');
INSERT INTO TEMPLE VALUES(510,110,550,'1966/05/04','1986/11/01',200,NULL,  1,'CAMPOS, ROMULO');
INSERT INTO TEMPLE VALUES(550,111,780,'1970/01/10','1988/01/21',100,120,   0,'SANTOS, SANCHO');

ALTER TABLE TDEPTO
ADD    FOREIGN KEY(DIREC)  REFERENCES TEMPLE(NUMEM);
COMMIT;

SET SQL_SAFE_UPDATES=0;
UPDATE TEMPLE
SET salar = (salar*1000)/(166.386);

